/*
 * generated by Xtext 2.10.0
 */
package fr.mleduc.tests

import com.google.inject.Inject
import fr.mleduc.mLang.Model
import fr.mleduc.mMLang.Metamodel
import javax.inject.Provider
import org.eclipse.xtext.junit4.InjectWith
import org.eclipse.xtext.junit4.XtextRunner
import org.eclipse.xtext.junit4.validation.ValidationTestHelper
import org.eclipse.xtext.resource.XtextResourceSet
import org.junit.Test
import org.junit.runner.RunWith

@RunWith(XtextRunner)
@InjectWith(NewInjector)
class MLangParsingTest {

	@Inject SmartParseHelper<Model> parseHelperM
	@Inject SmartParseHelper<Metamodel> parseHelperMM
	@Inject extension ValidationTestHelper
	@Inject Provider<XtextResourceSet> resourceSetProvider

	@Test
	def void loadModel() {
		val ressourceSet = resourceSetProvider.get

		val mmp = parseHelperMM.parse('''
			package l
			
			class String {}
			
			class Long {}
			
			class A {
				@ name: String [1..1]
				@ age: Long [1..1]
				@ friends: A [0..*]
			}
		''', ressourceSet, "mmlang")
		val mp = parseHelperM.parse('''
			model ml metamodel l
			
			instance a: A {
			  name = "Hello"
			  age = 1
			  friends = {}
			}
			
			instance b: A {
			  name = "World"
			  age = 2
			  friends = {a}
			}
		''', ressourceSet, "mlang")

		mmp.assertNoErrors
		mp.assertNoErrors
	}

}
