package csv2md

import java.io.File
import java.nio.file.FileSystems
import org.jsoup.Jsoup
import java.nio.charset.Charset
import java.nio.file.Files

class ApplicationHTML {
	extension Utils = new Utils

	def void run() {
		val targetDirectory = "/tmp/generation_html"
		val readFile = "/tmp/parsers.html"

		val targetDirectoryDir = FileSystems.getDefault().getPath(targetDirectory)

		targetDirectoryDir.clean
		targetDirectoryDir.init

		val doc = Jsoup.parse(new File(readFile), Charset.defaultCharset.toString);

		val divs = doc.select("body div.tabberlive div.tabbertab div.tabberlive div.tabbertab.tabbertabhide")

		divs.forEach[
			val name = it.select('h2').head.text
			val fileMd = targetDirectoryDir.resolve('''«name».md''')
			
			Files.write(fileMd, '''
				# «name»
				
				«IF !links.empty»
					## Links
					«FOR link : links»
						- «link»
					«ENDFOR»
					
				«ENDIF»
				## Description
				«description»
				
				## Examples
				
				    TODO
				
				## Key sources
				
				    TODO
			'''.toString.getBytes(Charset.defaultCharset))
		]
		]
	}

	def static void main(String[] args) {
		new ApplicationHTML().run
	}
}
