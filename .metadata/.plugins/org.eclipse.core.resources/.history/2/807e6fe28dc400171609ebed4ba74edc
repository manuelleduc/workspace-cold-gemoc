package fr.mleduc.generator

import fr.mleduc.explicitOperations.Model
import org.jgrapht.Graph
import org.jgrapht.graph.DefaultEdge
import org.jgrapht.graph.SimpleGraph
import org.jgrapht.traverse.DepthFirstIterator

class LanguageBuildPlanGenerator {
	def buildPlan(Model model) {
		val languages = model.languages

		val Graph<String, DefaultEdge> graph = new SimpleGraph(DefaultEdge)

		languages.forEach[graph.addVertex(it.name)]
		languages.forEach [f |
			f.dependencies.forEach [
				graph.addEdge(f.name, it.type.name)
			]
		]
		val dfi = new DepthFirstIterator(graph)
		
		dfi.map[it].join('\n')

		val l = newArrayList()
		val s = languages.filter[dependencies.empty].toList

		while (!s.empty) {
			val x = s.head
			s.remove(x)
			l.add(x)

			x.dependencies.forEach [
				x.dependencies.remove(it)
				if (it.type.dependencies.empty)
					s.add(it.type)
			]
		}

		''''''
	}
}
